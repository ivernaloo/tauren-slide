(function(a,b){var c=a.NTES||{};c.ui||(c.ui={});var d={forward:function(a){var b=this,c=Math.abs(b._bPos)-a;b._setPos(c),0==c&&b.stop()},backward:function(a){var b=this,c=b._bPos+a;c=b._bRange>c?c:b._bRange,b._setPos(c),c==b._bRange&&b.stop()}};c.ui.Scroll=function(a,d,e,f){if(arguments.length){var g=this;if(g.constructor=arguments.callee,g._axis="y"==d?"y":"x",g._fix="x"==g._axis?{pos:"left",offsetSize:"offsetWidth",pageAxis:"pageX",offsetPos:"left",scrollPos:"scrollLeft"}:{pos:"top",offsetSize:"offsetHeight",pageAxis:"pageY",offsetPos:"offsetTop",scrollPos:"scrollTop"},g.fps=Math.ceil(f.fps/50)||13,g.fps=13>g.fps?13:g.fps,g.lpf=10,g.speed=40,c.browser.msie&&(g.speed=20),g._body=a,g._bCnt=a.parentNode,g._bRange=Math.max(0,g._body[g._fix.offsetSize]-g._bCnt[g._fix.offsetSize]),g._bPos=g._body.offsetLeft,c(g._bCnt).addCss("overflow:hidden"),e!==b){g._handle=e,g._hCnt=e.parentNode,g._hPos=0,g._hRange=Math.max(0,g._hCnt[g._fix.offsetSize]-g._handle[g._fix.offsetSize]),g.bhRate=g._hRange?g._bRange/g._hRange:0;var h=new c.ui.Mouse(g._handle);h.mouseStart=g._mouseStart.bind(g),h.mouseDrag=g._mouseDrag.bind(g),h.mouseStop=g._mouseStop.bind(g),c(g._hCnt).addEvent("click",g._mouseClick.bind(g))}}},c.ui.Scroll.prototype={start:function(a,c){var e=this;if(e._timer==b){a="forward"==a?"forward":"backward",e._move=d[a];var f={length:isNaN(c)?-1:parseInt(c)};e._timer=setInterval(e._scroll.bind(e,f),e.fps),e.onStart&&e.onStart()}},stop:function(){var a=this;return a._timer!==b&&(clearTimeout(a._timer),a._timer=b,a.onStop&&a.onStop()),this},scrollTo:function(a){var b=this,c=a;0>c?b.stop().start("forward",-1*c):b.stop().start("backward",c)},_scroll:function(a){var b=this,c=b.lpf;0!==a.length?(a.length>0&&(c=Math.min(b.lpf*Math.ceil(a.length/b.speed),a.length),a.length-=c),b._move(c)):b.stop()},_setPos:function(a){var b=this;b._bPos=a,b._body.style.left=-b._bPos+"px",b._handle&&(b._hPos=b.bhRate?a/b.bhRate:0,b._handle.addCss(b._fix.pos+":"+b._hPos+"px"))},_mouseStart:function(a){var b=this;return b._diffPos=a[b._fix.pageAxis]-b._handle[b._fix.offsetPos],!0},_mouseDrag:function(a){var b=this,c=Math.max(0,Math.min(a[b._fix.pageAxis]-b._diffPos,b._hRange));return b._setPos(c*b.bhRate),!1},_mouseStop:function(){return!1},_mouseClick:function(a){for(var b=this,c=b._hCnt,d=c[b._fix.offsetPos];c.offsetParent;)c=c.offsetParent,d+=c[b._fix.offsetPos];b.scrollTo((a[b._fix.pageAxis]-b._handle[b._fix.offsetSize]/2-d)*b.bhRate)}},c.ui.Carousel=function(a,b,d,e){var f=this;if(f.ctrls=a,f.cons=b,f.css=d,f.defaults={auto:!1,interval:5e3,pause:"hover",event:"mouseover"},f.options=c.util.extend(f.defaults,e),f.event=f.options.event||f.defaults.event,f.btn={},f.scrol=[],f.step,f.btn.prev=f.options.prev,f.btn.next=f.options.next,!(3>arguments.length)){if(f.cons.length!=f.ctrls.length)throw"can not match ctrls("+f.ctrls.length+") and contents("+f.cons.length+")";f.activeMap={prev:function(a){for(var b=a.previousSibling;b;b=b.previousSibling)if(1===b.nodeType&&b!==a)return b},next:function(a){for(var b=a.nextSibling;b;b=b.nextSibling)if(1===b.nodeType&&b!==a)return b}},f.consMap={first:function(a){return a[0]},last:function(a){return a[a.length-1]}},f.stepMap={x:function(a){return a.offsetWidth},y:function(a){return a.offsetHeight}},f.step=f.stepMap.x(f.cons[0]),f.current||f.cons.each(function(a){this.className.indexOf(f.css)>-1&&(f.current=a)}),c(f.ctrls[f.current]).addCss(f.css),f.ctrls.each(function(a){c(f.ctrls[a]).addEvent(f.event,function(){f.to(a)})}),f.btn.prev&&("click"!=f.event&&f.btn.prev.addEvent("click",function(){return f.prev(),!1}),f.btn.prev.addEvent(f.event,f.prev.bind(f))),f.btn.next&&("click"!=f.event&&f.btn.next.addEvent("click",function(){return f.next(),!1}),f.btn.next.addEvent(f.event,f.next.bind(f))),f.total=f.cons.length,f.cycle()}},c.ui.Carousel.prototype={getStyle:function(a,b){var c="";return document.defaultView&&document.defaultView.getComputedStyle?c=document.defaultView.getComputedStyle(a,"").getPropertyValue(b):a.currentStyle&&(b=b.replace(/\-(\w)/g,function(a,b){return b.toUpperCase()}),c=a.currentStyle[b]),c},cycle:function(){var b=this;return b.paused=!1,b.options.auto&&(b.interval=setInterval(function(){b.next(),b.sliding=!1},b.options.interval)),this},to:function(a){var c=this;return c.cons[c.current]||c.cons[0],a>c.cons.length-1||0>a?b:c.current==a?c.pause().cycle():c.slide(a>c.current?"next":"prev",c.cons[a])},pause:function(){var b=this;return b.paused=!0,clearInterval(b.interval),b.interval=null,b},next:function(a){var c=this;return a&&a.preventDefault(),c.sliding?(c.sliding=!1,b):c.slide("next")},prev:function(a){var c=this;return a&&a.preventDefault(),c.sliding?(c.sliding=!1,b):c.slide("prev")},slide:function(a,d){var f,h,e=this,i=e.interval,j="next"==a?"left":"right",k="next"==a?"first":"last";if(f=e.cons[e.current]||e.cons[0],h=d||e.activeMap[a](f),h=h||e.consMap[k](e.cons),this.sliding=!0,i&&e.pause(),!(h.className.indexOf(e.css)>-1)){switch("left"==j?(c(f.parentNode).addCss("position:relative;width:"+2*e.step+"px;overflow:hidden;zoom:1;position:relative;left:0px;height:"+e.stepMap.y(f)+"px;"),c(f.parentNode.parentNode).addCss("position:relative;overflow:hidden;zoom:1;width:"+e.step+"px;"),c(h).addCss("position:absolute;top:0px;left:"+e.step+"px;zoom:1;display:block"),c(f).addCss("position:absolute;top:0px;left:0;display:block;zoom:1;")):(c(f.parentNode).addCss("position:relative;width:"+2*e.step+"px;overflow:hidden;zoom:1;position:relative;left:-"+e.step+"px;height:"+e.stepMap.y(f)+"px;"),c(f.parentNode.parentNode).addCss("position:relative;overflow:hidden;zoom:1;width:"+e.step+"px;"),c(h).addCss("position:absolute;top:0px;left:0px;zoom:1;display:block"),c(f).addCss("position:absolute;top:0px;left:"+e.step+"px;display:block;zoom:1;")),e.s=new NTES.ui.Scroll(f.parentNode,"x",b,{fps:e.options.interval}),e.cons.each(function(a){e.cons[a]==h&&(e.nextIndex=a)}),c(e.ctrls[e.current]).removeCss(e.css),c(e.ctrls[e.nextIndex]).addCss(e.css),j){case"left":e.s.scrollTo(e.step);break;case"right":e.s.scrollTo(-e.step)}return this.sliding=!1,e.s.onStop=function(){"left"==j?(f.removeCss(e.css),f.removeCss("position:absolute;top:0px;left:0;display:block;"),c(h).removeCss("left:"+e.step+"px;"),c(f.parentNode).removeCss("width:"+2*e.step+"px;left:-"+e.step+"px;"),h.addCss(e.css)):(f.removeCss(e.css),h.addCss(e.css),c(h.parentNode).removeCss("position:relative;width:"+2*e.step+"px;overflow:hidden;left:0px;"),c(h).removeCss("position:absolute;top:0px;left:0px;zoom:1;display:block"),c(f).removeCss("position:absolute;top:0px;left:"+e.step+"px;display:block;zoom:1;"))},e.current=e.nextIndex,i&&e.cycle(),e}}}})(window);
